/*
    Events Calendar - v0.1.0 - [last build on 2014-03-29]
    https://github.com/pcaldredbann/EventsCalendar
    Copyright (c) 2014 Paul Aldred-Bann
    Licensed MIT
*/
!function(a){"use strict";function b(b){var d=this;this.initialPeriod=ko.observable(new Date(b.period.year,b.period.month,1,0,0,0,0)),this.startDate=ko.computed(function(){if(this.initialPeriod()){for(var a=new Date(d.initialPeriod());1!==a.getDay();)a.setDate(a.getDate()-1);return a}},this),this.endDate=ko.computed(function(){if(this.startDate()){var a=new Date(this.startDate());return a.setDate(a.getDate()+41),a}},this),this.days=ko.computed(function(){if(this.startDate()&&this.endDate()){var a=[],b=new Date(this.startDate());do a.push(new c({date:new Date(b)})),b.setDate(b.getDate()+1);while(b.getTime()<this.endDate().getTime());return a}},this),this.weeks=ko.computed(function(){if(this.days()){for(var a=[],b=0;b<this.days().length;b+=7)a.push(this.days().slice(b,7));return a}},this),this.prevPeriod=ko.computed(function(){return a.EventsCalendar.formatDate(this.startDate())},this),this.nextPeriod=ko.computed(function(){return a.EventsCalendar.formatDate(this.endDate())},this),this.getDate=function(a){return ko.utils.arrayFirst(d.days(),function(b){return b.date().getTime()===a.getTime()})},this.createEvent=function(a,b){var c=d.getDate(a);if(c.event())throw"There is already an event scheduled on this date.";c.event(b)}}function c(a){this.date=ko.observable(new Date(a.date)),this.event=ko.observable(a.event)}a.fn.EventsCalendar=function(c){return c=a.extend({period:{month:(new Date).getMonth(),year:(new Date).getFullYear()}},c),this.length?this.each(function(){ko.applyBindings(new b(c),this)}):void 0},a.EventsCalendar=a.fn.EventsCalendar,a.EventsCalendar.formatDate=function(a){if(a){var b=new Date(a),c=b.getFullYear(),d=b.getMonth(),e=b.getDate();return[e,d,c].join("/")}},a.expr[":"].EventsCalendar=function(a){return ko.dataFor(a)}}(jQuery);